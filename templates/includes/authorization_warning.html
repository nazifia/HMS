{% comment %}
Reusable template partial for displaying authorization warning banner.

Usage:
    {% include 'includes/authorization_warning.html' with patient=patient consultation=consultation %}
    {% include 'includes/authorization_warning.html' with patient=patient referral=referral %}

Parameters:
    - patient: The patient object
    - consultation: The consultation object (optional)
    - referral: The referral object (optional)
    - custom_message: Custom warning message (optional)
{% endcomment %}

{% if patient %}
    {% if patient.patient_type == 'nhia' or patient.nhia_info %}
        {% if consultation and consultation.requires_authorization %}
            <div class="alert alert-warning border-warning mb-4" role="alert">
                <div class="d-flex align-items-start">
                    <div class="flex-shrink-0">
                        <i class="fas fa-exclamation-triangle fa-2x text-warning"></i>
                    </div>
                    <div class="flex-grow-1 ms-3">
                        <h5 class="alert-heading mb-2">
                            <i class="fas fa-shield-alt me-2"></i>
                            Desk Office Authorization Required
                        </h5>
                        <p class="mb-2">
                            <strong>{{ patient.get_full_name }}</strong> is an NHIA patient being seen in a non-NHIA consulting room.
                        </p>
                        <hr>
                        <div class="mb-0">
                            <p class="mb-2"><strong>What this means:</strong></p>
                            <ul class="mb-2">
                                <li>All services (prescriptions, lab tests, radiology) require desk office authorization</li>
                                <li>An authorization code must be obtained before services can be delivered</li>
                                <li>The authorization code will be validated before dispensing or processing</li>
                            </ul>
                            <p class="mb-0">
                                <i class="fas fa-info-circle me-1"></i>
                                <strong>Action Required:</strong> Contact the desk office to generate an authorization code for this consultation.
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        {% elif referral and referral.requires_authorization %}
            <div class="alert alert-warning border-warning mb-4" role="alert">
                <div class="d-flex align-items-start">
                    <div class="flex-shrink-0">
                        <i class="fas fa-exclamation-triangle fa-2x text-warning"></i>
                    </div>
                    <div class="flex-grow-1 ms-3">
                        <h5 class="alert-heading mb-2">
                            <i class="fas fa-shield-alt me-2"></i>
                            Desk Office Authorization Required for Referral
                        </h5>
                        <p class="mb-2">
                            <strong>{{ patient.get_full_name }}</strong> is an NHIA patient being referred from NHIA to a non-NHIA unit.
                        </p>
                        <hr>
                        <div class="mb-0">
                            <p class="mb-2"><strong>What this means:</strong></p>
                            <ul class="mb-2">
                                <li>This referral requires desk office authorization</li>
                                <li>An authorization code must be obtained before the referral can be processed</li>
                                <li>Services in the referred unit will also require authorization</li>
                            </ul>
                            <p class="mb-0">
                                <i class="fas fa-info-circle me-1"></i>
                                <strong>Action Required:</strong> Contact the desk office to generate an authorization code for this referral.
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        {% elif custom_message %}
            <div class="alert alert-warning border-warning mb-4" role="alert">
                <div class="d-flex align-items-start">
                    <div class="flex-shrink-0">
                        <i class="fas fa-exclamation-triangle fa-2x text-warning"></i>
                    </div>
                    <div class="flex-grow-1 ms-3">
                        <h5 class="alert-heading mb-2">
                            <i class="fas fa-shield-alt me-2"></i>
                            Authorization Required
                        </h5>
                        <p class="mb-0">{{ custom_message }}</p>
                    </div>
                </div>
            </div>
        {% endif %}
    {% endif %}
{% endif %}

